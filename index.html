<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syncfy - Tu Música, Sincronizada</title>
    <meta name="description" content="Syncfy, el mejor clon de música con estilo premium.">
    <meta name="theme-color" content="#FFC212">
    <meta name="referrer" content="no-referrer">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <link rel="icon" type="image/png" href="icons/icon-192.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="style.css">

    <!-- Icons (Phosphor Icons for a premium look) -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsmediatags/3.9.5/jsmediatags.min.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo-container">
                <img src="icons/icon-192.png" alt="Syncfy" style="width: 40px; height: 40px;">
                <span class="logo-text">Syncfy</span>
            </div>

            <nav class="main-nav">
                <ul>
                    <li class="active"><a href="#"><i class="ph-fill ph-house"></i> Inicio</a></li>
                    <li><a href="#"><i class="ph-fill ph-magnifying-glass"></i> Buscar</a></li>
                    <li><a href="#"><i class="ph-fill ph-books"></i> Tu Biblioteca</a></li>
                    <li id="navCloud"><a href="#" style="color: var(--accent-color);"><i class="ph-bold ph-cloud"></i>
                            Tu Nube</a></li>
                </ul>
            </nav>

            <div class="playlists-nav">
                <div class="playlist-header">
                    <span>PLAYLISTS</span>
                    <div style="display: flex; gap: 8px;">
                        <button class="add-playlist" onclick="openCreatePlaylistModal()" title="Crear Playlist Nueva"><i
                                class="ph-bold ph-plus"></i></button>
                        <button class="add-playlist" id="addLocalBtn" title="Importar canciones locales"><i
                                class="ph-bold ph-upload-simple"></i></button>
                    </div>
                    <input type="file" id="localFileInput" multiple accept="audio/*" style="display: none;">
                </div>
                <ul class="playlist-list" id="playlistList">
                    <li data-type="local" class="active-playlist">Canciones Locales</li>
                    <li>Mis Favoritos</li>
                    <li>Éxitos España</li>
                </ul>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <div class="nav-arrows">
                    <button class="nav-btn"><i class="ph-bold ph-caret-left"></i></button>
                    <button class="nav-btn"><i class="ph-bold ph-caret-right"></i></button>
                </div>

                <!-- Mobile Header Content -->
                <div class="mobile-header-content" style="display: none;">
                    <div class="user-menu mobile-user">
                        <div class="avatar">
                            <i class="ph-fill ph-user"></i>
                        </div>
                    </div>
                    <div class="filter-pills">
                        <button class="pill active">Todos</button>
                        <button class="pill">Música</button>
                        <button class="pill">Pódcasts</button>
                    </div>
                </div>

                <div class="user-menu desktop-user">
                    <button class="install-pwa hidden" id="installBtn">Instalar App</button>
                    <div class="avatar">
                        <i class="ph-fill ph-user"></i>
                    </div>
                </div>
            </header>

            <div class="content-scroll">
                <!-- Hero Section -->
                <section class="hero-section">
                    <div class="hero-content">
                        <h1>Buenos días</h1>
                        <div class="hero-grid" id="heroGrid">
                            <!-- Dynamic Content -->
                        </div>
                    </div>
                </section>

                <!-- Sections -->
                <section class="music-section">
                    <div class="section-header">
                        <h2>Hecho para ti</h2>
                        <a href="#">Ver todo</a>
                    </div>
                    <div class="cards-container" id="madeForYou">
                        <!-- Dynamic Cards -->
                    </div>
                </section>

                <section class="music-section">
                    <div class="section-header">
                        <h2>Escuchado recientemente</h2>
                        <a href="#">Ver todo</a>
                    </div>
                    <div class="cards-container" id="recentlyPlayed">
                        <!-- Dynamic Cards -->
                    </div>
                </section>

                <div class="spacer" style="height: 100px;"></div>
            </div>
        </main>

        <!-- Player Bar -->
        <footer class="player-bar">
            <!-- Left: Now Playing -->
            <div class="now-playing">
                <div class="track-art" id="currentArt"></div>
                <div class="track-info">
                    <div class="track-name-row">
                        <span class="track-name" id="trackName">Selecciona una canción</span>
                        <button class="like-btn"><i class="ph-fill ph-check-circle"></i></button>
                    </div>
                    <div class="artist-name" id="artistName">Syncfy</div>
                </div>
            </div>

            <!-- Center: Controls & Progress -->
            <div class="player-center">
                <div class="player-controls">
                    <div class="control-buttons">
                        <button class="shuffle"><i class="ph ph-shuffle"></i></button>
                        <button class="prev"><i class="ph-fill ph-skip-back"></i></button>
                        <button class="play-pause" id="playPauseBtn"><i class="ph-fill ph-play"></i></button>
                        <button class="next"><i class="ph-fill ph-skip-forward"></i></button>
                        <button class="repeat"><i class="ph ph-repeat"></i></button>
                    </div>
                </div>
                <div class="progress-container">
                    <span class="time current">0:00</span>
                    <div class="progress-bar-wrapper">
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                    </div>
                    <span class="time total">0:00</span>
                </div>
            </div>

            <!-- Right: Volume & Extra -->
            <div class="volume-controls">
                <button class="extra-btn"><i class="ph ph-microphone-stage"></i></button>
                <button class="extra-btn" id="desktopQueueBtn"><i class="ph ph-list"></i></button>
                <div class="volume-wrapper">
                    <i class="ph-fill ph-speaker-high"></i>
                    <div class="volume-bar-wrapper">
                        <div class="volume-bar">
                            <div class="volume-fill" style="width: 70%;"></div>
                        </div>
                    </div>
                </div>
                <button class="extra-btn"><i class="ph ph-arrows-out-simple"></i></button>
            </div>
        </footer>

        <!-- Mobile Navigation -->
        <nav class="mobile-nav">
            <a href="#" class="active" onclick="renderHome()"><i class="ph-fill ph-house"></i><span>Inicio</span></a>
            <a href="#"><i class="ph-fill ph-magnifying-glass"></i><span>Buscar</span></a>
            <a href="#"><i class="ph-fill ph-books"></i><span>Biblioteca</span></a>
            <a href="#" id="mobileNavCloud"><i class="ph-bold ph-cloud"></i><span>Nube</span></a>
        </nav>
    </div>

    <!-- Full Screen Player Overlay (Mobile) -->
    <div id="fullPlayer" class="full-player-overlay">
        <div class="full-player-header">
            <button class="icon-btn" id="closeFullPlayer"><i class="ph ph-caret-down"></i></button>
            <div class="header-text">
                <span class="subtext">REPRODUCIENDO DESDE</span>
                <span class="context-text" id="fpContext">Tu Biblioteca</span>
            </div>
            <button class="icon-btn"><i class="ph ph-dots-three-vertical"></i></button>
        </div>

        <div class="full-player-art">
            <img id="fpArt" src="icons/icon-512.png" alt="Album Art">
        </div>

        <div class="full-player-info">
            <div class="info-text">
                <h3 id="fpTitle">Canción</h3>
                <p id="fpArtist">Artista</p>
            </div>
            <button class="like-btn" id="fpLikeBtn"><i class="ph-fill ph-heart"></i></button>
        </div>

        <div class="full-player-progress">
            <div class="progress-bar-wrapper" id="fpProgressWrapper">
                <div class="progress-bar">
                    <div class="progress-fill" id="fpProgressFill"></div>
                </div>
            </div>
            <div class="time-row">
                <span class="time" id="fpCurrentTime">0:00</span>
                <span class="time" id="fpTotalTime">0:00</span>
            </div>
        </div>

        <div class="full-player-controls">
            <button class="control-btn shuffle" id="fpShuffle"><i class="ph ph-shuffle"></i></button>
            <button class="control-btn prev" id="fpPrev"><i class="ph-fill ph-skip-back"></i></button>
            <button class="play-pause-btn" id="fpPlayPause"><i class="ph-fill ph-play"></i></button>
            <button class="control-btn next" id="fpNext"><i class="ph-fill ph-skip-forward"></i></button>
            <button class="control-btn repeat" id="fpRepeat"><i class="ph ph-repeat"></i></button>
        </div>

        <div class="full-player-bottom">
            <button class="icon-btn"><i class="ph ph-speaker-high"></i></button>
            <button class="icon-btn" id="mobileQueueBtn"><i class="ph ph-list"></i></button>
        </div>
    </div>

    <!-- Queue Overlay -->
    <div id="queueOverlay" class="queue-overlay">
        <div class="queue-header">
            <h3>Cola de reproducción</h3>
            <button id="closeQueueBtn" class="icon-btn"><i class="ph ph-x"></i></button>
        </div>
        <div class="queue-content" id="queueContent">
            <!-- Dynamic Queue Content -->
        </div>
    </div>

    <!-- PIN Modal -->
    <div id="pinModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>Acceso a Nube Privada</h2>
            <p>Introduce tu PIN para acceder a tu música en Drive.</p>
            <form id="pinForm">
                <input type="text" name="username" value="user" style="display:none;" autocomplete="username">
                <input type="password" id="pinInput" placeholder="PIN Secreto" class="pin-input"
                    autocomplete="current-password">
                <button type="submit" id="pinSubmitBtn" class="pin-submit-btn">Acceder</button>
            </form>
            <p id="pinError" style="color: #ff4d4d; display: none; margin-top: 15px; font-weight: bold;">PIN incorrecto
                o error de conexión</p>
            <button id="closeModalBtn" class="close-modal-btn"><i class="ph ph-x"></i></button>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu" style="display: none;">
        <button id="ctxQueue">Añadir a la cola</button>
        <div class="ctx-divider"></div>
        <button id="ctxAddToPlaylist">Añadir a playlist...</button>
        <!-- Submenu for playlists could be rendered dynamically or handled via a secondary modal -->
    </div>

    <!-- Create Playlist Modal -->
    <div id="playlistModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>Crear Playlist</h2>
            <input type="text" id="newPlaylistName" class="pin-input" placeholder="Nombre de la playlist">
            <button id="createPlaylistConfirmBtn" class="pin-submit-btn">Crear</button>
            <button id="closePlaylistModalBtn" class="close-modal-btn"><i class="ph ph-x"></i></button>
        </div>
    </div>

    <!-- Add To Playlist Modal (Selector) -->
    <div id="addToPlaylistModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>Añadir a Playlist</h2>
            <ul id="addToPlaylistList" class="modal-list">
                <!-- Dynamic List -->
            </ul>
            <button id="closeAddToPlaylistModalBtn" class="close-modal-btn"><i class="ph ph-x"></i></button>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>